# Data Model: Authentication

## Overview
This document defines the data models for the Authentication feature, including entities, relationships, and validation rules. Note that the primary user model is managed by Better Auth, but we define how it relates to our application data.

## Entities

### User (from Better Auth)
**Description**: Represents an authenticated user in the system (managed by Better Auth).

**Fields**:
- `id`: String (Primary Key, provided by Better Auth)
- `email`: String (Unique, required, provided by Better Auth)
- `name`: String (optional, provided by Better Auth)
- `image`: String (optional, user profile image URL)
- `emailVerified`: DateTime (timestamp when email was verified)
- `createdAt`: DateTime (Auto-generated by Better Auth)
- `updatedAt`: DateTime (Auto-generated by Better Auth)

**Validation Rules**:
- Email must be a valid email format
- Email must be unique across all users
- Name must be 1-100 characters if provided

**Relationships**:
- Has many Tasks (via tasks.user_id foreign key)
- Each user can only access their own tasks

### Session (from Better Auth)
**Description**: Represents an active user session (managed by Better Auth).

**Fields**:
- `id`: String (Primary Key)
- `userId`: String (Foreign Key to User)
- `expiresAt`: DateTime (When the session expires)
- `createdAt`: DateTime (When the session was created)

**Relationships**:
- Belongs to one User (via userId foreign key)

### Task (Application Model)
**Description**: Represents a user's task with title, description, and completion status.

**Fields**:
- `id`: Integer (Primary Key, Auto-generated)
- `user_id`: String (Foreign Key to User.id, required)
- `title`: String (1-200 characters, required)
- `description`: Text (up to 1000 characters, optional, nullable)
- `completed`: Boolean (default: false)
- `created_at`: DateTime (Auto-generated)
- `updated_at`: DateTime (Auto-generated, updates on modification)

**Validation Rules**:
- Title must be 1-200 characters
- Description must be â‰¤ 1000 characters if provided
- Task must be associated with a valid user_id
- Completed defaults to false when creating a new task

**Relationships**:
- Belongs to one User (via user_id foreign key)
- User can have many Tasks

## Security Considerations

### Access Control
- Users can only access/modify their own tasks
- Backend must verify JWT token and match user ID in token with requested resources
- All API endpoints require valid JWT token

### Token Management
- JWT tokens expire after 7 days as specified
- Refresh token mechanism if needed for extended sessions
- Secure token storage using httpOnly cookies

## Constraints

1. **Referential Integrity**: All tasks must have a valid user_id that exists in the users table
2. **Data Validation**: Title length and description length constraints enforced at database level
3. **Ownership**: Users can only access/modify their own tasks
4. **Authentication**: All API requests must include valid JWT token
5. **Authorization**: JWT token must match the requested resource owner